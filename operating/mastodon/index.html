<!doctype html><html lang=en class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Now that you have your Mastodon instance deployed, you're going to want to start using it!"><meta name=author content="Anthony Rodgers"><link href=https://docs.govsocial.org/operating/mastodon/ rel=canonical><link href=../dashboards/mastodon/ rel=prev><link rel=icon href=../../images/govsocial_logo.png><meta name=generator content="mkdocs-1.4.2, mkdocs-material-9.0.8"><title>Mastodon Operations - GOVSocial Project Documentation</title><link rel=stylesheet href=../../assets/stylesheets/main.0d440cfe.min.css><link rel=stylesheet href=../../assets/stylesheets/palette.2505c338.min.css><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Ubuntu:300,300i,400,400i,700,700i%7CUbuntu+Mono:400,400i,700,700i&display=fallback"><style>:root{--md-text-font:"Ubuntu";--md-code-font:"Ubuntu Mono"}</style><link rel=stylesheet href=../../extras/css/icons.css><link rel=stylesheet href=../../stylesheets/govsocial.css><script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script></head> <body dir=ltr data-md-color-scheme=default data-md-color-primary data-md-color-accent> <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#mastodon-operations class=md-skip> Skip to content </a> </div> <div data-md-component=announce> <aside class=md-banner> <div class="md-banner__inner md-grid md-typeset"> <button class="md-banner__button md-icon" aria-label="Don't show this again"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg> </button> <a rel=me href=https://mstdn.ca/@cunningpike></a> <style>.md-banner a,.md-banner a:focus,.md-banner a:hover{color:currentColor}.md-banner strong{white-space:nowrap}.md-banner .twitter{margin-left:.2em;color:#00acee}</style> <div align=center> <a href=https://github.com/sponsors/govsocial-org> Please consider supporting us via <strong>GitHub Sponsors</strong> </a> </div> </div> <script>var content,el=document.querySelector("[data-md-component=announce]");el&&(content=el.querySelector(".md-typeset"),__md_hash(content.innerHTML)===__md_get("__announce")&&(el.hidden=!0))</script> </aside> </div> <header class="md-header md-header--lifted" data-md-component=header> <nav class="md-header__inner md-grid" aria-label=Header> <a href=../.. title="GOVSocial Project Documentation" class="md-header__button md-logo" aria-label="GOVSocial Project Documentation" data-md-component=logo> <img src=../../images/govsocial_logo_white.png alt=logo> </a> <label class="md-header__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg> </label> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> GOVSocial Project Documentation </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> Mastodon Operations </span> </div> </div> </div> <form class=md-header__option data-md-component=palette> <input class=md-option data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme=default data-md-color-primary data-md-color-accent aria-label="Burn my eyes!" type=radio name=__palette id=__palette_1> <label class="md-header__button md-icon" title="Burn my eyes!" for=__palette_2 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg> </label> <input class=md-option data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme=slate data-md-color-primary data-md-color-accent aria-label="Love my eyes!" type=radio name=__palette id=__palette_2> <label class="md-header__button md-icon" title="Love my eyes!" for=__palette_1 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12c0-2.42-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg> </label> </form> <label class="md-header__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=Search placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query required> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg> </label> <nav class=md-search__options aria-label=Search> <a href=javascript:void(0) class="md-search__icon md-icon" title=Share aria-label=Share data-clipboard data-clipboard-text data-md-component=search-share tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7 0-.24-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91 1.61 0 2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08Z"/></svg> </a> <button type=reset class="md-search__icon md-icon" title=Clear aria-label=Clear tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg> </button> </nav> <div class=md-search__suggest data-md-component=search-suggest></div> </form> <div class=md-search__output> <div class=md-search__scrollwrap data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Initializing search </div> <ol class=md-search-result__list role=presentation></ol> </div> </div> </div> </div> </div> <div class=md-header__source> <a href=https://github.com/govsocial-org/govsocial-org.github.io/ title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 496 512"><!-- Font Awesome Free 6.2.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg> </div> <div class=md-source__repository> govsocial-org.github.io </div> </a> </div> </nav> <nav class=md-tabs aria-label=Tabs data-md-component=tabs> <div class="md-tabs__inner md-grid"> <ul class=md-tabs__list> <li class=md-tabs__item> <a href=../.. class=md-tabs__link> Home </a> </li> <li class=md-tabs__item> <a href=../../building/ class=md-tabs__link> Building GOVSocial </a> </li> <li class=md-tabs__item> <a href=../ class="md-tabs__link md-tabs__link--active"> Operating GOVSocial </a> </li> </ul> </div> </nav> </header> <div class=md-container data-md-component=container> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary md-nav--lifted" aria-label=Navigation data-md-level=0> <label class=md-nav__title for=__drawer> <a href=../.. title="GOVSocial Project Documentation" class="md-nav__button md-logo" aria-label="GOVSocial Project Documentation" data-md-component=logo> <img src=../../images/govsocial_logo_white.png alt=logo> </a> GOVSocial Project Documentation </label> <div class=md-nav__source> <a href=https://github.com/govsocial-org/govsocial-org.github.io/ title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 496 512"><!-- Font Awesome Free 6.2.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg> </div> <div class=md-source__repository> govsocial-org.github.io </div> </a> </div> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../.. class=md-nav__link> Home </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2> <div class="md-nav__link md-nav__link--index "> <a href=../../building/ >Building GOVSocial</a> <label for=__nav_2> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_2_label aria-expanded=false> <label class=md-nav__title for=__nav_2> <span class="md-nav__icon md-icon"></span> Building GOVSocial </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2_2> <label class=md-nav__link for=__nav_2_2 id=__nav_2_2_label tabindex=0> Preparation <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_2_2_label aria-expanded=false> <label class=md-nav__title for=__nav_2_2> <span class="md-nav__icon md-icon"></span> Preparation </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../building/cluster/ class=md-nav__link> Creating the Cluster </a> </li> <li class=md-nav__item> <a href=../../building/domains/ class=md-nav__link> DNS Domains </a> </li> <li class=md-nav__item> <a href=../../building/email/ class=md-nav__link> Transactional Email </a> </li> <li class=md-nav__item> <a href=../../building/storage/ class=md-nav__link> S3 Storage </a> </li> <li class=md-nav__item> <a href=../../building/postgresql/ class=md-nav__link> PostgreSQL </a> </li> <li class=md-nav__item> <a href=../../building/fluxhelm/ class=md-nav__link> Flux/Helm </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2_3> <label class=md-nav__link for=__nav_2_3 id=__nav_2_3_label tabindex=0> Platform Installs <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_2_3_label aria-expanded=false> <label class=md-nav__title for=__nav_2_3> <span class="md-nav__icon md-icon"></span> Platform Installs </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../building/mastodon/ class=md-nav__link> Mastodon </a> </li> <li class=md-nav__item> <a href=../../building/fediblockhole/ class=md-nav__link> FediBlockHole </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3 checked> <div class="md-nav__link md-nav__link--index "> <a href=../ >Operating GOVSocial</a> <label for=__nav_3> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_3_label aria-expanded=true> <label class=md-nav__title for=__nav_3> <span class="md-nav__icon md-icon"></span> Operating GOVSocial </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3_2> <label class=md-nav__link for=__nav_3_2 id=__nav_3_2_label tabindex=0> General Operations <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_3_2_label aria-expanded=false> <label class=md-nav__title for=__nav_3_2> <span class="md-nav__icon md-icon"></span> General Operations </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../documentation/ class=md-nav__link> Documentation </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3_2_2> <label class=md-nav__link for=__nav_3_2_2 id=__nav_3_2_2_label tabindex=0> Dashboards <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=3 aria-labelledby=__nav_3_2_2_label aria-expanded=false> <label class=md-nav__title for=__nav_3_2_2> <span class="md-nav__icon md-icon"></span> Dashboards </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../dashboards/ class=md-nav__link> Installation </a> </li> <li class=md-nav__item> <a href=../dashboards/kubernetes/ class=md-nav__link> Kubernetes </a> </li> <li class=md-nav__item> <a href=../dashboards/cloudsql/ class=md-nav__link> Cloud SQL </a> </li> <li class=md-nav__item> <a href=../dashboards/cloudstorage/ class=md-nav__link> Cloud Storage </a> </li> <li class=md-nav__item> <a href=../dashboards/mastodon/ class=md-nav__link> Mastodon </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3_3 checked> <label class=md-nav__link for=__nav_3_3 id=__nav_3_3_label tabindex=0> Instance Operations <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_3_3_label aria-expanded=true> <label class=md-nav__title for=__nav_3_3> <span class="md-nav__icon md-icon"></span> Instance Operations </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--active"> <input class="md-nav__toggle md-toggle" type=checkbox id=__toc> <label class="md-nav__link md-nav__link--active" for=__toc> Mastodon <span class="md-nav__icon md-icon"></span> </label> <a href=./ class="md-nav__link md-nav__link--active"> Mastodon </a> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#administrator-access class=md-nav__link> Administrator Access </a> </li> <li class=md-nav__item> <a href=#backups class=md-nav__link> Backups </a> </li> <li class=md-nav__item> <a href=#account-registration-approval class=md-nav__link> Account Registration Approval </a> <nav class=md-nav aria-label="Account Registration Approval"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#tines-automation class=md-nav__link> Tines Automation </a> <nav class=md-nav aria-label="Tines Automation"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#mastodon-oauth-token class=md-nav__link> Mastodon OAuth Token </a> </li> <li class=md-nav__item> <a href=#tines-credential class=md-nav__link> Tines Credential </a> </li> <li class=md-nav__item> <a href=#tines-workflow class=md-nav__link> Tines Workflow </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#server-moderation class=md-nav__link> Server Moderation </a> <nav class=md-nav aria-label="Server Moderation"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#fediblockhole class=md-nav__link> FediBlockHole </a> <nav class=md-nav aria-label=FediBlockHole> <ul class=md-nav__list> <li class=md-nav__item> <a href=#selecting-a-merge-plan class=md-nav__link> Selecting a Merge Plan </a> </li> <li class=md-nav__item> <a href=#selecting-block-lists class=md-nav__link> Selecting Block Lists </a> </li> </ul> </nav> </li> </ul> </nav> </li> </ul> </nav> </li> </ul> </nav> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=sidebar data-md-type=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#administrator-access class=md-nav__link> Administrator Access </a> </li> <li class=md-nav__item> <a href=#backups class=md-nav__link> Backups </a> </li> <li class=md-nav__item> <a href=#account-registration-approval class=md-nav__link> Account Registration Approval </a> <nav class=md-nav aria-label="Account Registration Approval"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#tines-automation class=md-nav__link> Tines Automation </a> <nav class=md-nav aria-label="Tines Automation"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#mastodon-oauth-token class=md-nav__link> Mastodon OAuth Token </a> </li> <li class=md-nav__item> <a href=#tines-credential class=md-nav__link> Tines Credential </a> </li> <li class=md-nav__item> <a href=#tines-workflow class=md-nav__link> Tines Workflow </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#server-moderation class=md-nav__link> Server Moderation </a> <nav class=md-nav aria-label="Server Moderation"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#fediblockhole class=md-nav__link> FediBlockHole </a> <nav class=md-nav aria-label=FediBlockHole> <ul class=md-nav__list> <li class=md-nav__item> <a href=#selecting-a-merge-plan class=md-nav__link> Selecting a Merge Plan </a> </li> <li class=md-nav__item> <a href=#selecting-block-lists class=md-nav__link> Selecting Block Lists </a> </li> </ul> </nav> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class=md-content data-md-component=content> <article class="md-content__inner md-typeset"> <h1 id=mastodon-operations>Mastodon Operations<a class=headerlink href=#mastodon-operations title="Permanent link">&para;</a></h1> <p>Now that you have your Mastodon instance <a href=/building/mastodon/ >deployed</a>, you're going to want to start using it!</p> <h2 id=administrator-access>Administrator Access<a class=headerlink href=#administrator-access title="Permanent link">&para;</a></h2> <p>If you <a href=/building/mastodon/#general>recall</a>, the admin user that we specified in our Mastodon configuration didn't get created when we deployed our instance. Here's how we worked around that:</p> <ul> <li>Register the account you want to act as the owner of the instance, as a regular user, including confirming your email address.</li> <li>Connect to a running <code>mastodon-web</code> pod from your CLI machine by entering this: <div class=highlight><pre><span></span><code>~$<span class=w> </span>kubectl<span class=w> </span>get<span class=w> </span>pods<span class=w> </span>-n<span class=w> </span>mastodon
</code></pre></div> <div class="no-copy highlight"><pre><span></span><code>NAME<span class=w>                                          </span>READY<span class=w>   </span>STATUS
mastodon-media-remove-27895680-w6f95<span class=w>          </span><span class=m>0</span>/1<span class=w>     </span>Completed
mastodon-media-remove-27905760-2jnnd<span class=w>          </span><span class=m>0</span>/1<span class=w>     </span>Completed
mastodon-media-remove-27915840-mprc7<span class=w>          </span><span class=m>0</span>/1<span class=w>     </span>Completed
mastodon-redis-master-0<span class=w>                       </span><span class=m>1</span>/1<span class=w>     </span>Running
mastodon-redis-replicas-0<span class=w>                     </span><span class=m>1</span>/1<span class=w>     </span>Running
mastodon-redis-replicas-1<span class=w>                     </span><span class=m>1</span>/1<span class=w>     </span>Running
mastodon-redis-replicas-2<span class=w>                     </span><span class=m>1</span>/1<span class=w>     </span>Running
mastodon-sidekiq-all-queues-968db8b7c-77wjg<span class=w>   </span><span class=m>1</span>/1<span class=w>     </span>Running
mastodon-sidekiq-all-queues-968db8b7c-hh5kz<span class=w>   </span><span class=m>1</span>/1<span class=w>     </span>Running
mastodon-sidekiq-all-queues-968db8b7c-l7bjc<span class=w>   </span><span class=m>1</span>/1<span class=w>     </span>Running
mastodon-streaming-bb578b4bc-6pv56<span class=w>            </span><span class=m>1</span>/1<span class=w>     </span>Running
mastodon-streaming-bb578b4bc-7lc68<span class=w>            </span><span class=m>1</span>/1<span class=w>     </span>Running
mastodon-streaming-bb578b4bc-swjdh<span class=w>            </span><span class=m>1</span>/1<span class=w>     </span>Running
mastodon-web-6b7fb7f8d4-2d7gz<span class=w>                 </span><span class=m>1</span>/1<span class=w>     </span>Running
mastodon-web-6b7fb7f8d4-ds5vm<span class=w>                 </span><span class=m>1</span>/1<span class=w>     </span>Running
mastodon-web-6b7fb7f8d4-dvr4j<span class=w>                 </span><span class=m>1</span>/1<span class=w>     </span>Running
</code></pre></div> <div class=highlight><pre><span></span><code>~$<span class=w> </span>kubectl<span class=w> </span><span class=nb>exec</span><span class=w> </span>-it<span class=w> </span>mastodon-web-6b7fb7f8d4-dvr4j<span class=w> </span>-n<span class=w> </span>mastodon<span class=w> </span>/bin/sh
</code></pre></div></li> <li>It doesn't matter which <code>mastodon-web</code> pod you connect to, if there is more than one, like in the example above. Once you are connected to a pod, run the following: <div class=highlight><pre><span></span><code>$<span class=w> </span><span class=nv>RAILS_ENV</span><span class=o>=</span>production<span class=w> </span>bin/tootctl<span class=w> </span>accounts<span class=w> </span>modify<span class=w> </span><span class=o>{</span>username<span class=o>}</span><span class=w> </span>--role<span class=w> </span>Owner
</code></pre></div></li> </ul> <p>This will give your account owner and admin access to your Mastodon instance in the browser. The <code>Trends</code>, <code>Moderation</code>, <code>Administration</code>, <code>SideKiq</code>, and <code>PGHero</code> menu items are added to the menu in your regular user settings. Get used to keeping an eye on these regularly! A couple of general administrative tips:</p> <ul> <li>Be sure to walk through the <code>Server Settings</code> and set up, at a minumum, your <code>About</code> message and your <code>Server Rules</code>. Ours are <a href=https://mastodon.govsocial.org/about>here</a>.</li> <li>It is <strong>strongly advised</strong> that you add a trusted friend as another instance administrator. Until you do, you are the only person with that access. You will also use the <code>Roles</code> menu to manage your growing team of administrators and moderators as your instance grows.</li> <li>Keep an eye on your Sidekiq queues, especially anything in <code>Dead</code> and <code>Retries</code>. There will usually be some sort of error message for those that will help you troubleshoot the issue, particularly if your <a href=/building/mastodon/#smtp>SMTP configuration</a> isn't working.</li> <li>The first time you look at <code>PGHero</code>, it will tell you that the <code>pg-stats</code> extension needs to be enabled. Do this. Google Cloud SQL installs this extension by default, and if you followed the steps in our <a href=/building/mastodon/#postgresql>Postgres implementation</a>, you should be able to install it right from the browser. This will alert you to any slow-running queries in your database.</li> </ul> <h2 id=backups>Backups<a class=headerlink href=#backups title="Permanent link">&para;</a></h2> <p>Upholding the <a href=https://joinmastodon.org/covenant>Mastodon Server Covenant</a> means ensuring that our instance availability and configuration and our users' data must protected from loss. This means ensuring regular and frequent backups of:</p> <ul> <li><strong>Our PostgreSQL database.</strong> We perform automated nightly full database backups using <a href=https://cloud.google.com/sql/docs/postgres/backup-recovery/backups>Cloud SQL backups</a>, with a 7-day retention. We have also enabled <a href=https://cloud.google.com/sql/docs/postgres/backup-recovery/pitr>point-in-time recovery</a> with 7-day log retention.</li> <li><strong>Our Cloud Storage buckets.</strong> Google Cloud Storage is <a href=https://cloud.google.com/storage/docs/locations>geo-redundant</a>, meaning that data is redundant across at least two zones within at least one geographic place as soon as our users upload it. Our Cloud Storage is used solely for user-uploaded media, such as avatars, banners, and media attached to posts. We believe that geo-redundancy is sufficient to protect this data from loss.</li> <li><strong>GKE Clusters and persistent volume (PV) claims.</strong> We perform automated nightly cluster backups of our instance namespaces using <a href=https://cloud.google.com/kubernetes-engine/docs/add-on/backup-for-gke/concepts/backup-for-gke>Backup for GKE</a>, with a 7-day retention period.</li> </ul> <div class="admonition warning"> <p class=admonition-title>Warning</p> <p>Backup for GKE restores <strong>all</strong> the pods in the the scope of the backup plan, <strong>regardless of status</strong>. If, like we did, you created a lot of completed, terminated, and failed pods during your initial deployment, you will want to clear them out to minimize your backup costs. You can get a list of any such pods by running this in from your CLI machine:</p> <div class=highlight><pre><span></span><code>~$<span class=w> </span>kubectl<span class=w> </span>get<span class=w> </span>pods<span class=w> </span>--field-selector<span class=o>=</span>status.phase!<span class=o>=</span>Running<span class=w> </span>-A
</code></pre></div> <p>You can delete the pods by running this from your CLI machine: <div class=highlight><pre><span></span><code>~$<span class=w> </span>kubectl<span class=w> </span>delete<span class=w> </span>pods<span class=w> </span>--field-selector<span class=o>=</span>status.phase!<span class=o>=</span>Running<span class=w> </span>-A
</code></pre></div></p> </div> <h2 id=account-registration-approval>Account Registration Approval<a class=headerlink href=#account-registration-approval title="Permanent link">&para;</a></h2> <p>If you leave account registration open on your Mastodon instance this section won't apply, but we wanted to limit accounts on our platform instances to identified and verified public service users and agencies. In order to do this, we require that users sign up with their organizational email address, which we verify against information on the organization's website, among other sources.</p> <p>We wanted to automate this process as much as we could, partly to make the registration process as seamless as possible for our intended user community, and partly to reduce the administative burden of having to approve every single user.</p> <p>Many national governments own and administer a top-level or secondary-level DNS domain, use of which already requires that the organization to which a subdomain is being issued meets our criteria for a public service body. These include<sup id=fnref:1><a class=footnote-ref href=#fn:1>1</a></sup>:</p> <ul> <li><a href=https://get.gov/ >.gov</a></li> <li><a href=https://www.domainname.gov.au/ >.gov.au</a></li> <li><a href=https://en.wikipedia.org/wiki/.gc.ca>.gc.ca</a></li> <li><a href=https://www.gov.uk/apply-for-and-manage-a-gov-uk-domain-name>.gov.uk</a></li> <li><a href=https://wikis.ec.europa.eu/display/WEBGUIDE/01.+Europa+domain+and+subdomains+overview>.europa.eu</a></li> </ul> <p>There are also free personal email domains that we are reasonably certain are (or should!) never used by public service entities. These include<sup id=fnref:2><a class=footnote-ref href=#fn:2>2</a></sup>:</p> <ul> <li>gmail.com</li> <li>yahoo.com</li> <li>aol.com</li> </ul> <p>We automated the handling of both of these lists with a <a href=https://www.tines.com/ >Tines</a> workflow that uses the <a href=https://docs.joinmastodon.org/api/ >Mastodon API</a> to interact with our instance.</p> <h3 id=tines-automation>Tines Automation<a class=headerlink href=#tines-automation title="Permanent link">&para;</a></h3> <p>In order to automate the processing of registration requests, you will need:</p> <ul> <li>A <a href="https://login.tines.com/saml_idp/choose_tenant?sign_up=1">free Tines account</a>.</li> <li>An OAuth token for an account in your Mastodon instance with the <code>admin:read:accounts</code> and <code>admin:write:accounts</code> scopes.</li> </ul> <h4 id=mastodon-oauth-token>Mastodon OAuth Token<a class=headerlink href=#mastodon-oauth-token title="Permanent link">&para;</a></h4> <p>To generate the OAuth token for your Mastodon account, go to the <code>Development</code> item in your Mastodon account settings. Click <code>New Application</code>, and enter a suitable account name (eg. <code>Tines</code>). When you signed up for Tines and created your tenant, it was given a URL - enter that in the <code>Application website</code> field. Leave the <code>Redirect URI</code> field at its default setting for now.</p> <p>Scroll down the list of <code>Scopes</code> until you see <code>admin:read:accounts</code> and <code>admin:write:accounts</code> and check those. You can uncheck everything else in the <code>Scopes</code> area.</p> <p>When you're done, click <code>Submit</code>. Edit your newly created application by clicking on it. This will generate and display the OAuth token that you need at the top of the page. The <code>Client key</code> and <code>Client secret</code> are the values you will need for creating the Tines credential. You don't have to write these down - you'll be able to access them from this menu whenever you need them. Leave this screen open, and switch to your Tines tenant in a different browser tab.</p> <h4 id=tines-credential>Tines Credential<a class=headerlink href=#tines-credential title="Permanent link">&para;</a></h4> <p>In order for your Tines workflow to authenticate to your Mastodon instance, it will need this OAuth credential. You can create it in your Tines team (everyone gets a team in Tines, even if they are an individual user) by expanding your team name and clicking on <code>Credentials</code> and then <code>New Credential</code> in the screen that appears. Pick <code>OAuth 2.0</code> from the dropdown menu.</p> <p>Give your credential a suitable name, and then get ready to switch back and forth between this screen and your Mastodon <code>Development</code> screen as you set this up.</p> <p>The Tines screen will give you a <code>Callback URL</code>. Copy this and paste it into the <code>Redirect URI</code> field in your Mastodon screen. While you are in the Mastodon screen, copy and paste both the <code>Client key</code> and <code>Client secret</code> from there into the <code>Client ID</code> and <code>Client secret</code> fields respectively in your Tines screen. When you're done, click <code>Save</code> in the Mastodon screen, but leave that tab open.</p> <p>Switch back to Tines, and enter the scopes into the <code>Scopes</code> field, exactly like this:</p> <div class=highlight><pre><span></span><code>admin:read:accounts<span class=w> </span>admin:write:accounts
</code></pre></div> <p>Set the remaining values in the Tines screen as follows:</p> <ul> <li>Set <code>OAuth Provider</code> to <code>Manual</code></li> <li>Set <code>Grant type</code> to <code>Authorization code</code></li> <li>Set <code>OAuth authorization request URL</code> to <code>https://{instance-web_domain-value}/oauth/authorize</code></li> <li>Set <code>PKCE challenge method</code> to <code>SHA-256</code></li> <li>Set <code>OAuth token URL</code> to <code>https://{instance-web_domain-value}/oauth/token</code></li> <li>Set <code>Domains</code> to <code>{instance-web_domain-value}</code></li> <li>Make sure that <code>All teams &amp; drafts</code> is checked</li> </ul> <p>When you click <code>Save</code>, Tines will generate its OAuth token and, in your Mastodon screen, you should see a request for access which you can accept. Once that is complete, your OAuth token is ready for use in your Tines workflow.</p> <h4 id=tines-workflow>Tines Workflow<a class=headerlink href=#tines-workflow title="Permanent link">&para;</a></h4> <p>Workflows in Tines are called "Stories", so click on the <code>Stories</code> item in the <code>Your drafts</code> part of your Tines menu. To make it easier for you to set everything up, we have exported our Tines workflow as a <a href=https://www.json.org/json-en.html>JSON</a> file, which you can save locally and import using the <code>Import</code> button in this screen<sup id=fnref:3><a class=footnote-ref href=#fn:3>3</a></sup>.</p> <div class="admonition note"> <p class=admonition-title>Note</p> <p>You should replace <code>{my-mastodon-web_domain}</code>, <code>{my-credential}</code>, and <code>{my-email_address}</code> with your own values directly in the file <strong>before</strong> importing it. Remember to get rid of the braces <code>{}</code> as well!</p> </div> <p>When you have saved and tested your draft Story, you can publish it in Tines, and you should be all set!</p> <details class=example> <summary>Tines Workflow</summary> <div class=highlight><pre><span></span><code><span class=p>{</span>
<span class=w>  </span><span class=nt>&quot;schema_version&quot;</span><span class=p>:</span><span class=w> </span><span class=mi>6</span><span class=p>,</span>
<span class=w>  </span><span class=nt>&quot;standard_lib_version&quot;</span><span class=p>:</span><span class=w> </span><span class=mi>13</span><span class=p>,</span>
<span class=w>  </span><span class=nt>&quot;action_runtime_version&quot;</span><span class=p>:</span><span class=w> </span><span class=mi>1</span><span class=p>,</span>
<span class=w>  </span><span class=nt>&quot;name&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;Auto-approve Mastodon accounts&quot;</span><span class=p>,</span>
<span class=w>  </span><span class=nt>&quot;description&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;Auto-approves pending Mastodon accounts with email addresses in known domains&quot;</span><span class=p>,</span>
<span class=w>  </span><span class=nt>&quot;guid&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;b9700ef606a5f4badfed04ea42155b12&quot;</span><span class=p>,</span>
<span class=w>  </span><span class=nt>&quot;slug&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;auto_approve_mastodon_accounts&quot;</span><span class=p>,</span>
<span class=w>  </span><span class=nt>&quot;exported_at&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;2023-02-02T21:10:22Z&quot;</span><span class=p>,</span>
<span class=w>  </span><span class=nt>&quot;agents&quot;</span><span class=p>:</span><span class=w> </span><span class=p>[</span>
<span class=w>    </span><span class=p>{</span>
<span class=w>      </span><span class=nt>&quot;type&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;Agents::HTTPRequestAgent&quot;</span><span class=p>,</span>
<span class=w>      </span><span class=nt>&quot;name&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;Get Pending User Accounts&quot;</span><span class=p>,</span>
<span class=w>      </span><span class=nt>&quot;disabled&quot;</span><span class=p>:</span><span class=w> </span><span class=kc>false</span><span class=p>,</span>
<span class=w>      </span><span class=nt>&quot;description&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;&quot;</span><span class=p>,</span>
<span class=w>      </span><span class=nt>&quot;guid&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;db1336c590099940d47bb2389b634d2b&quot;</span><span class=p>,</span>
<span class=w>      </span><span class=nt>&quot;options&quot;</span><span class=p>:</span><span class=w> </span><span class=p>{</span>
<span class=w>        </span><span class=nt>&quot;url&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;https://{my-mastodon-web_domain}/api/v2/admin/accounts&quot;</span><span class=p>,</span>
<span class=w>        </span><span class=nt>&quot;content_type&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;application_json&quot;</span><span class=p>,</span>
<span class=w>        </span><span class=nt>&quot;method&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;get&quot;</span><span class=p>,</span>
<span class=w>        </span><span class=nt>&quot;payload&quot;</span><span class=p>:</span><span class=w> </span><span class=p>{</span>
<span class=w>          </span><span class=nt>&quot;origin&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;local&quot;</span><span class=p>,</span>
<span class=w>          </span><span class=nt>&quot;status&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;pending&quot;</span><span class=p>,</span>
<span class=w>          </span><span class=nt>&quot;limit&quot;</span><span class=p>:</span><span class=w> </span><span class=mi>200</span>
<span class=w>        </span><span class=p>},</span>
<span class=w>        </span><span class=nt>&quot;headers&quot;</span><span class=p>:</span><span class=w> </span><span class=p>{</span>
<span class=w>          </span><span class=nt>&quot;Authorization&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;Bearer &lt;&lt;CREDENTIAL.{my-credential}&gt;&gt;&quot;</span>
<span class=w>        </span><span class=p>}</span>
<span class=w>      </span><span class=p>},</span>
<span class=w>      </span><span class=nt>&quot;reporting&quot;</span><span class=p>:</span><span class=w> </span><span class=p>{</span>
<span class=w>        </span><span class=nt>&quot;time_saved_value&quot;</span><span class=p>:</span><span class=w> </span><span class=mi>0</span><span class=p>,</span>
<span class=w>        </span><span class=nt>&quot;time_saved_unit&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;minutes&quot;</span>
<span class=w>      </span><span class=p>},</span>
<span class=w>      </span><span class=nt>&quot;monitoring&quot;</span><span class=p>:</span><span class=w> </span><span class=p>{</span>
<span class=w>        </span><span class=nt>&quot;monitor_all_events&quot;</span><span class=p>:</span><span class=w> </span><span class=kc>false</span><span class=p>,</span>
<span class=w>        </span><span class=nt>&quot;monitor_failures&quot;</span><span class=p>:</span><span class=w> </span><span class=kc>false</span><span class=p>,</span>
<span class=w>        </span><span class=nt>&quot;monitor_no_events_emitted&quot;</span><span class=p>:</span><span class=w> </span><span class=kc>null</span>
<span class=w>      </span><span class=p>},</span>
<span class=w>      </span><span class=nt>&quot;width&quot;</span><span class=p>:</span><span class=w> </span><span class=kc>null</span><span class=p>,</span>
<span class=w>      </span><span class=nt>&quot;schedule&quot;</span><span class=p>:</span><span class=w> </span><span class=p>[</span>
<span class=w>        </span><span class=p>{</span>
<span class=w>          </span><span class=nt>&quot;cron&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;*/5 * * * *&quot;</span><span class=p>,</span>
<span class=w>          </span><span class=nt>&quot;timezone&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;America/Detroit&quot;</span>
<span class=w>        </span><span class=p>}</span>
<span class=w>      </span><span class=p>]</span>
<span class=w>    </span><span class=p>},</span>
<span class=w>    </span><span class=p>{</span>
<span class=w>      </span><span class=nt>&quot;type&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;Agents::EventTransformationAgent&quot;</span><span class=p>,</span>
<span class=w>      </span><span class=nt>&quot;name&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;Extract Pre-Approved Accounts&quot;</span><span class=p>,</span>
<span class=w>      </span><span class=nt>&quot;disabled&quot;</span><span class=p>:</span><span class=w> </span><span class=kc>false</span><span class=p>,</span>
<span class=w>      </span><span class=nt>&quot;description&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;&quot;</span><span class=p>,</span>
<span class=w>      </span><span class=nt>&quot;guid&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;b2f9f20787f3decfe59cc4f5edb041d9&quot;</span><span class=p>,</span>
<span class=w>      </span><span class=nt>&quot;options&quot;</span><span class=p>:</span><span class=w> </span><span class=p>{</span>
<span class=w>        </span><span class=nt>&quot;mode&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;message_only&quot;</span><span class=p>,</span>
<span class=w>        </span><span class=nt>&quot;loop&quot;</span><span class=p>:</span><span class=w> </span><span class=kc>false</span><span class=p>,</span>
<span class=w>        </span><span class=nt>&quot;payload&quot;</span><span class=p>:</span><span class=w> </span><span class=p>{</span>
<span class=w>          </span><span class=nt>&quot;pre-approved_accounts&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;=FILTER(get_pending_user_accounts.body, LAMBDA(element, MATCH(element.email,\&quot;(.*\\.gov|.*\\.gov\\.au|.*\\.gov\\.uk|.*\\.gc\\.ca)\&quot;)))&quot;</span>
<span class=w>        </span><span class=p>}</span>
<span class=w>      </span><span class=p>},</span>
<span class=w>      </span><span class=nt>&quot;reporting&quot;</span><span class=p>:</span><span class=w> </span><span class=p>{</span>
<span class=w>        </span><span class=nt>&quot;time_saved_value&quot;</span><span class=p>:</span><span class=w> </span><span class=mi>0</span><span class=p>,</span>
<span class=w>        </span><span class=nt>&quot;time_saved_unit&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;minutes&quot;</span>
<span class=w>      </span><span class=p>},</span>
<span class=w>      </span><span class=nt>&quot;monitoring&quot;</span><span class=p>:</span><span class=w> </span><span class=p>{</span>
<span class=w>        </span><span class=nt>&quot;monitor_all_events&quot;</span><span class=p>:</span><span class=w> </span><span class=kc>false</span><span class=p>,</span>
<span class=w>        </span><span class=nt>&quot;monitor_failures&quot;</span><span class=p>:</span><span class=w> </span><span class=kc>false</span><span class=p>,</span>
<span class=w>        </span><span class=nt>&quot;monitor_no_events_emitted&quot;</span><span class=p>:</span><span class=w> </span><span class=kc>null</span>
<span class=w>      </span><span class=p>},</span>
<span class=w>      </span><span class=nt>&quot;width&quot;</span><span class=p>:</span><span class=w> </span><span class=kc>null</span><span class=p>,</span>
<span class=w>      </span><span class=nt>&quot;schedule&quot;</span><span class=p>:</span><span class=w> </span><span class=kc>null</span>
<span class=w>    </span><span class=p>},</span>
<span class=w>    </span><span class=p>{</span>
<span class=w>      </span><span class=nt>&quot;type&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;Agents::EventTransformationAgent&quot;</span><span class=p>,</span>
<span class=w>      </span><span class=nt>&quot;name&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;Explode Pre-Approved Accounts&quot;</span><span class=p>,</span>
<span class=w>      </span><span class=nt>&quot;disabled&quot;</span><span class=p>:</span><span class=w> </span><span class=kc>false</span><span class=p>,</span>
<span class=w>      </span><span class=nt>&quot;description&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;&quot;</span><span class=p>,</span>
<span class=w>      </span><span class=nt>&quot;guid&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;4368d4a7e09e8b0ba1278435502d6c58&quot;</span><span class=p>,</span>
<span class=w>      </span><span class=nt>&quot;options&quot;</span><span class=p>:</span><span class=w> </span><span class=p>{</span>
<span class=w>        </span><span class=nt>&quot;mode&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;explode&quot;</span><span class=p>,</span>
<span class=w>        </span><span class=nt>&quot;path&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;=extract_pre_approved_accounts[\&quot;pre-approved_accounts\&quot;]&quot;</span><span class=p>,</span>
<span class=w>        </span><span class=nt>&quot;to&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;individual_item&quot;</span>
<span class=w>      </span><span class=p>},</span>
<span class=w>      </span><span class=nt>&quot;reporting&quot;</span><span class=p>:</span><span class=w> </span><span class=p>{</span>
<span class=w>        </span><span class=nt>&quot;time_saved_value&quot;</span><span class=p>:</span><span class=w> </span><span class=mi>0</span><span class=p>,</span>
<span class=w>        </span><span class=nt>&quot;time_saved_unit&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;minutes&quot;</span>
<span class=w>      </span><span class=p>},</span>
<span class=w>      </span><span class=nt>&quot;monitoring&quot;</span><span class=p>:</span><span class=w> </span><span class=p>{</span>
<span class=w>        </span><span class=nt>&quot;monitor_all_events&quot;</span><span class=p>:</span><span class=w> </span><span class=kc>false</span><span class=p>,</span>
<span class=w>        </span><span class=nt>&quot;monitor_failures&quot;</span><span class=p>:</span><span class=w> </span><span class=kc>false</span><span class=p>,</span>
<span class=w>        </span><span class=nt>&quot;monitor_no_events_emitted&quot;</span><span class=p>:</span><span class=w> </span><span class=kc>null</span>
<span class=w>      </span><span class=p>},</span>
<span class=w>      </span><span class=nt>&quot;width&quot;</span><span class=p>:</span><span class=w> </span><span class=kc>null</span><span class=p>,</span>
<span class=w>      </span><span class=nt>&quot;schedule&quot;</span><span class=p>:</span><span class=w> </span><span class=kc>null</span>
<span class=w>    </span><span class=p>},</span>
<span class=w>    </span><span class=p>{</span>
<span class=w>      </span><span class=nt>&quot;type&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;Agents::HTTPRequestAgent&quot;</span><span class=p>,</span>
<span class=w>      </span><span class=nt>&quot;name&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;Approve Pre-Approved Accounts&quot;</span><span class=p>,</span>
<span class=w>      </span><span class=nt>&quot;disabled&quot;</span><span class=p>:</span><span class=w> </span><span class=kc>false</span><span class=p>,</span>
<span class=w>      </span><span class=nt>&quot;description&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;&quot;</span><span class=p>,</span>
<span class=w>      </span><span class=nt>&quot;guid&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;9e5ad0f2d078d50408a3a91e643c8f40&quot;</span><span class=p>,</span>
<span class=w>      </span><span class=nt>&quot;options&quot;</span><span class=p>:</span><span class=w> </span><span class=p>{</span>
<span class=w>        </span><span class=nt>&quot;url&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;https://{my-mastodon-web_domain}/api/v1/admin/accounts/&lt;&lt;explode_pre_approved_accounts.individual_item.id&gt;&gt;/approve&quot;</span><span class=p>,</span>
<span class=w>        </span><span class=nt>&quot;content_type&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;application_json&quot;</span><span class=p>,</span>
<span class=w>        </span><span class=nt>&quot;method&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;post&quot;</span><span class=p>,</span>
<span class=w>        </span><span class=nt>&quot;headers&quot;</span><span class=p>:</span><span class=w> </span><span class=p>{</span>
<span class=w>          </span><span class=nt>&quot;Authorization&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;Bearer &lt;&lt;CREDENTIAL.{my-credential}&gt;&gt;&quot;</span>
<span class=w>        </span><span class=p>}</span>
<span class=w>      </span><span class=p>},</span>
<span class=w>      </span><span class=nt>&quot;reporting&quot;</span><span class=p>:</span><span class=w> </span><span class=p>{</span>
<span class=w>        </span><span class=nt>&quot;time_saved_value&quot;</span><span class=p>:</span><span class=w> </span><span class=mi>0</span><span class=p>,</span>
<span class=w>        </span><span class=nt>&quot;time_saved_unit&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;minutes&quot;</span>
<span class=w>      </span><span class=p>},</span>
<span class=w>      </span><span class=nt>&quot;monitoring&quot;</span><span class=p>:</span><span class=w> </span><span class=p>{</span>
<span class=w>        </span><span class=nt>&quot;monitor_all_events&quot;</span><span class=p>:</span><span class=w> </span><span class=kc>false</span><span class=p>,</span>
<span class=w>        </span><span class=nt>&quot;monitor_failures&quot;</span><span class=p>:</span><span class=w> </span><span class=kc>false</span><span class=p>,</span>
<span class=w>        </span><span class=nt>&quot;monitor_no_events_emitted&quot;</span><span class=p>:</span><span class=w> </span><span class=kc>null</span>
<span class=w>      </span><span class=p>},</span>
<span class=w>      </span><span class=nt>&quot;width&quot;</span><span class=p>:</span><span class=w> </span><span class=kc>null</span><span class=p>,</span>
<span class=w>      </span><span class=nt>&quot;schedule&quot;</span><span class=p>:</span><span class=w> </span><span class=kc>null</span>
<span class=w>    </span><span class=p>},</span>
<span class=w>    </span><span class=p>{</span>
<span class=w>      </span><span class=nt>&quot;type&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;Agents::EventTransformationAgent&quot;</span><span class=p>,</span>
<span class=w>      </span><span class=nt>&quot;name&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;Extract Pre-Rejected Accounts&quot;</span><span class=p>,</span>
<span class=w>      </span><span class=nt>&quot;disabled&quot;</span><span class=p>:</span><span class=w> </span><span class=kc>false</span><span class=p>,</span>
<span class=w>      </span><span class=nt>&quot;description&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;&quot;</span><span class=p>,</span>
<span class=w>      </span><span class=nt>&quot;guid&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;fcfe50b2803bc32077c04dce841a33f2&quot;</span><span class=p>,</span>
<span class=w>      </span><span class=nt>&quot;options&quot;</span><span class=p>:</span><span class=w> </span><span class=p>{</span>
<span class=w>        </span><span class=nt>&quot;mode&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;message_only&quot;</span><span class=p>,</span>
<span class=w>        </span><span class=nt>&quot;loop&quot;</span><span class=p>:</span><span class=w> </span><span class=kc>false</span><span class=p>,</span>
<span class=w>        </span><span class=nt>&quot;payload&quot;</span><span class=p>:</span><span class=w> </span><span class=p>{</span>
<span class=w>          </span><span class=nt>&quot;pre-rejected_accounts&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;=FILTER(get_pending_user_accounts.body, LAMBDA(element, MATCH(element.email,\&quot;(.*\\gmail\\.com|.*\\aol\\.com|.*\\yahoo\\.com)\&quot;)))&quot;</span>
<span class=w>        </span><span class=p>}</span>
<span class=w>      </span><span class=p>},</span>
<span class=w>      </span><span class=nt>&quot;reporting&quot;</span><span class=p>:</span><span class=w> </span><span class=p>{</span>
<span class=w>        </span><span class=nt>&quot;time_saved_value&quot;</span><span class=p>:</span><span class=w> </span><span class=mi>0</span><span class=p>,</span>
<span class=w>        </span><span class=nt>&quot;time_saved_unit&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;minutes&quot;</span>
<span class=w>      </span><span class=p>},</span>
<span class=w>      </span><span class=nt>&quot;monitoring&quot;</span><span class=p>:</span><span class=w> </span><span class=p>{</span>
<span class=w>        </span><span class=nt>&quot;monitor_all_events&quot;</span><span class=p>:</span><span class=w> </span><span class=kc>false</span><span class=p>,</span>
<span class=w>        </span><span class=nt>&quot;monitor_failures&quot;</span><span class=p>:</span><span class=w> </span><span class=kc>false</span><span class=p>,</span>
<span class=w>        </span><span class=nt>&quot;monitor_no_events_emitted&quot;</span><span class=p>:</span><span class=w> </span><span class=kc>null</span>
<span class=w>      </span><span class=p>},</span>
<span class=w>      </span><span class=nt>&quot;width&quot;</span><span class=p>:</span><span class=w> </span><span class=kc>null</span><span class=p>,</span>
<span class=w>      </span><span class=nt>&quot;schedule&quot;</span><span class=p>:</span><span class=w> </span><span class=kc>null</span>
<span class=w>    </span><span class=p>},</span>
<span class=w>    </span><span class=p>{</span>
<span class=w>      </span><span class=nt>&quot;type&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;Agents::EventTransformationAgent&quot;</span><span class=p>,</span>
<span class=w>      </span><span class=nt>&quot;name&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;Explode Pre-Rejected Accounts&quot;</span><span class=p>,</span>
<span class=w>      </span><span class=nt>&quot;disabled&quot;</span><span class=p>:</span><span class=w> </span><span class=kc>false</span><span class=p>,</span>
<span class=w>      </span><span class=nt>&quot;description&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;&quot;</span><span class=p>,</span>
<span class=w>      </span><span class=nt>&quot;guid&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;5c672894c3e6af04e43a7e5b69de1bd9&quot;</span><span class=p>,</span>
<span class=w>      </span><span class=nt>&quot;options&quot;</span><span class=p>:</span><span class=w> </span><span class=p>{</span>
<span class=w>        </span><span class=nt>&quot;mode&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;explode&quot;</span><span class=p>,</span>
<span class=w>        </span><span class=nt>&quot;path&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;=extract_pre_rejected_accounts[\&quot;pre-rejected_accounts\&quot;]&quot;</span><span class=p>,</span>
<span class=w>        </span><span class=nt>&quot;to&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;individual_item&quot;</span>
<span class=w>      </span><span class=p>},</span>
<span class=w>      </span><span class=nt>&quot;reporting&quot;</span><span class=p>:</span><span class=w> </span><span class=p>{</span>
<span class=w>        </span><span class=nt>&quot;time_saved_value&quot;</span><span class=p>:</span><span class=w> </span><span class=mi>0</span><span class=p>,</span>
<span class=w>        </span><span class=nt>&quot;time_saved_unit&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;minutes&quot;</span>
<span class=w>      </span><span class=p>},</span>
<span class=w>      </span><span class=nt>&quot;monitoring&quot;</span><span class=p>:</span><span class=w> </span><span class=p>{</span>
<span class=w>        </span><span class=nt>&quot;monitor_all_events&quot;</span><span class=p>:</span><span class=w> </span><span class=kc>false</span><span class=p>,</span>
<span class=w>        </span><span class=nt>&quot;monitor_failures&quot;</span><span class=p>:</span><span class=w> </span><span class=kc>false</span><span class=p>,</span>
<span class=w>        </span><span class=nt>&quot;monitor_no_events_emitted&quot;</span><span class=p>:</span><span class=w> </span><span class=kc>null</span>
<span class=w>      </span><span class=p>},</span>
<span class=w>      </span><span class=nt>&quot;width&quot;</span><span class=p>:</span><span class=w> </span><span class=kc>null</span><span class=p>,</span>
<span class=w>      </span><span class=nt>&quot;schedule&quot;</span><span class=p>:</span><span class=w> </span><span class=kc>null</span>
<span class=w>    </span><span class=p>},</span>
<span class=w>    </span><span class=p>{</span>
<span class=w>      </span><span class=nt>&quot;type&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;Agents::HTTPRequestAgent&quot;</span><span class=p>,</span>
<span class=w>      </span><span class=nt>&quot;name&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;Reject Pre-Rejected Accounts&quot;</span><span class=p>,</span>
<span class=w>      </span><span class=nt>&quot;disabled&quot;</span><span class=p>:</span><span class=w> </span><span class=kc>false</span><span class=p>,</span>
<span class=w>      </span><span class=nt>&quot;description&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;&quot;</span><span class=p>,</span>
<span class=w>      </span><span class=nt>&quot;guid&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;c1958d276321136a1a86833ec33a87ea&quot;</span><span class=p>,</span>
<span class=w>      </span><span class=nt>&quot;options&quot;</span><span class=p>:</span><span class=w> </span><span class=p>{</span>
<span class=w>        </span><span class=nt>&quot;url&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;https://{my-mastodon-web_domain}/api/v1/admin/accounts/&lt;&lt;explode_pre_rejected_accounts.individual_item.id&gt;&gt;/reject&quot;</span><span class=p>,</span>
<span class=w>        </span><span class=nt>&quot;content_type&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;application_json&quot;</span><span class=p>,</span>
<span class=w>        </span><span class=nt>&quot;method&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;post&quot;</span><span class=p>,</span>
<span class=w>        </span><span class=nt>&quot;headers&quot;</span><span class=p>:</span><span class=w> </span><span class=p>{</span>
<span class=w>          </span><span class=nt>&quot;Authorization&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;Bearer &lt;&lt;CREDENTIAL.{my-credential}&gt;&gt;&quot;</span>
<span class=w>        </span><span class=p>}</span>
<span class=w>      </span><span class=p>},</span>
<span class=w>      </span><span class=nt>&quot;reporting&quot;</span><span class=p>:</span><span class=w> </span><span class=p>{</span>
<span class=w>        </span><span class=nt>&quot;time_saved_value&quot;</span><span class=p>:</span><span class=w> </span><span class=mi>0</span><span class=p>,</span>
<span class=w>        </span><span class=nt>&quot;time_saved_unit&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;minutes&quot;</span>
<span class=w>      </span><span class=p>},</span>
<span class=w>      </span><span class=nt>&quot;monitoring&quot;</span><span class=p>:</span><span class=w> </span><span class=p>{</span>
<span class=w>        </span><span class=nt>&quot;monitor_all_events&quot;</span><span class=p>:</span><span class=w> </span><span class=kc>false</span><span class=p>,</span>
<span class=w>        </span><span class=nt>&quot;monitor_failures&quot;</span><span class=p>:</span><span class=w> </span><span class=kc>false</span><span class=p>,</span>
<span class=w>        </span><span class=nt>&quot;monitor_no_events_emitted&quot;</span><span class=p>:</span><span class=w> </span><span class=kc>null</span>
<span class=w>      </span><span class=p>},</span>
<span class=w>      </span><span class=nt>&quot;width&quot;</span><span class=p>:</span><span class=w> </span><span class=kc>null</span><span class=p>,</span>
<span class=w>      </span><span class=nt>&quot;schedule&quot;</span><span class=p>:</span><span class=w> </span><span class=kc>null</span>
<span class=w>    </span><span class=p>}</span>
<span class=w>  </span><span class=p>],</span>
<span class=w>  </span><span class=nt>&quot;diagram_notes&quot;</span><span class=p>:</span><span class=w> </span><span class=p>[],</span>
<span class=w>  </span><span class=nt>&quot;links&quot;</span><span class=p>:</span><span class=w> </span><span class=p>[</span>
<span class=w>    </span><span class=p>{</span>
<span class=w>      </span><span class=nt>&quot;source&quot;</span><span class=p>:</span><span class=w> </span><span class=mi>0</span><span class=p>,</span>
<span class=w>      </span><span class=nt>&quot;receiver&quot;</span><span class=p>:</span><span class=w> </span><span class=mi>1</span>
<span class=w>    </span><span class=p>},</span>
<span class=w>    </span><span class=p>{</span>
<span class=w>      </span><span class=nt>&quot;source&quot;</span><span class=p>:</span><span class=w> </span><span class=mi>0</span><span class=p>,</span>
<span class=w>      </span><span class=nt>&quot;receiver&quot;</span><span class=p>:</span><span class=w> </span><span class=mi>4</span>
<span class=w>    </span><span class=p>},</span>
<span class=w>    </span><span class=p>{</span>
<span class=w>      </span><span class=nt>&quot;source&quot;</span><span class=p>:</span><span class=w> </span><span class=mi>1</span><span class=p>,</span>
<span class=w>      </span><span class=nt>&quot;receiver&quot;</span><span class=p>:</span><span class=w> </span><span class=mi>2</span>
<span class=w>    </span><span class=p>},</span>
<span class=w>    </span><span class=p>{</span>
<span class=w>      </span><span class=nt>&quot;source&quot;</span><span class=p>:</span><span class=w> </span><span class=mi>2</span><span class=p>,</span>
<span class=w>      </span><span class=nt>&quot;receiver&quot;</span><span class=p>:</span><span class=w> </span><span class=mi>3</span>
<span class=w>    </span><span class=p>},</span>
<span class=w>    </span><span class=p>{</span>
<span class=w>      </span><span class=nt>&quot;source&quot;</span><span class=p>:</span><span class=w> </span><span class=mi>4</span><span class=p>,</span>
<span class=w>      </span><span class=nt>&quot;receiver&quot;</span><span class=p>:</span><span class=w> </span><span class=mi>5</span>
<span class=w>    </span><span class=p>},</span>
<span class=w>    </span><span class=p>{</span>
<span class=w>      </span><span class=nt>&quot;source&quot;</span><span class=p>:</span><span class=w> </span><span class=mi>5</span><span class=p>,</span>
<span class=w>      </span><span class=nt>&quot;receiver&quot;</span><span class=p>:</span><span class=w> </span><span class=mi>6</span>
<span class=w>    </span><span class=p>}</span>
<span class=w>  </span><span class=p>],</span>
<span class=w>  </span><span class=nt>&quot;diagram_layout&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;{\&quot;db1336c590099940d47bb2389b634d2b\&quot;:[495,45],\&quot;b2f9f20787f3decfe59cc4f5edb041d9\&quot;:[330,135],\&quot;4368d4a7e09e8b0ba1278435502d6c58\&quot;:[330,225],\&quot;9e5ad0f2d078d50408a3a91e643c8f40\&quot;:[330,330],\&quot;fcfe50b2803bc32077c04dce841a33f2\&quot;:[585,135],\&quot;5c672894c3e6af04e43a7e5b69de1bd9\&quot;:[585,225],\&quot;c1958d276321136a1a86833ec33a87ea\&quot;:[585,330]}&quot;</span><span class=p>,</span>
<span class=w>  </span><span class=nt>&quot;send_to_story_enabled&quot;</span><span class=p>:</span><span class=w> </span><span class=kc>false</span><span class=p>,</span>
<span class=w>  </span><span class=nt>&quot;entry_agent_guid&quot;</span><span class=p>:</span><span class=w> </span><span class=kc>null</span><span class=p>,</span>
<span class=w>  </span><span class=nt>&quot;exit_agent_guids&quot;</span><span class=p>:</span><span class=w> </span><span class=p>[],</span>
<span class=w>  </span><span class=nt>&quot;exit_agent_guid&quot;</span><span class=p>:</span><span class=w> </span><span class=kc>null</span><span class=p>,</span>
<span class=w>  </span><span class=nt>&quot;keep_events_for&quot;</span><span class=p>:</span><span class=w> </span><span class=mi>604800</span><span class=p>,</span>
<span class=w>  </span><span class=nt>&quot;reporting_status&quot;</span><span class=p>:</span><span class=w> </span><span class=kc>true</span><span class=p>,</span>
<span class=w>  </span><span class=nt>&quot;send_to_story_access&quot;</span><span class=p>:</span><span class=w> </span><span class=kc>null</span><span class=p>,</span>
<span class=w>  </span><span class=nt>&quot;story_library_metadata&quot;</span><span class=p>:</span><span class=w> </span><span class=p>{},</span>
<span class=w>  </span><span class=nt>&quot;recipients&quot;</span><span class=p>:</span><span class=w> </span><span class=p>[</span>
<span class=w>    </span><span class=s2>&quot;{my-email_address}&quot;</span>
<span class=w>  </span><span class=p>],</span>
<span class=w>  </span><span class=nt>&quot;story_level_monitoring_enabled&quot;</span><span class=p>:</span><span class=w> </span><span class=kc>false</span><span class=p>,</span>
<span class=w>  </span><span class=nt>&quot;monitor_failures&quot;</span><span class=p>:</span><span class=w> </span><span class=kc>false</span><span class=p>,</span>
<span class=w>  </span><span class=nt>&quot;send_to_stories&quot;</span><span class=p>:</span><span class=w> </span><span class=p>[],</span>
<span class=w>  </span><span class=nt>&quot;form&quot;</span><span class=p>:</span><span class=w> </span><span class=kc>null</span><span class=p>,</span>
<span class=w>  </span><span class=nt>&quot;forms&quot;</span><span class=p>:</span><span class=w> </span><span class=p>[]</span>
<span class=p>}</span>
</code></pre></div> </details> <h2 id=server-moderation>Server Moderation<a class=headerlink href=#server-moderation title="Permanent link">&para;</a></h2> <p>As part of creating an instance safe for public service users and agencies using their public personas, it is important that we can maintain a reliable server moderation policy, limiting federation with instances that are conflict with <a href=https://mastodon.govsocial.org/about/ >our server rules</a>.</p> <p>Also, as a small team, we wanted to automate the maintainance of our base server moderation list from these sources, to allow us to dedicate our resources to the moderation of our specific instance. Enter the <a href=https://github.com/eigenmagic/fediblockhole>FediBlockHole</a> project<sup id=fnref:4><a class=footnote-ref href=#fn:4>4</a></sup>.</p> <h3 id=fediblockhole>FediBlockHole<a class=headerlink href=#fediblockhole title="Permanent link">&para;</a></h3> <p>We have documented how we containerized and deployed FediBlockHole in our cluster <a href=/building/fediblockhole/ >here</a>. Once that was done, we needed to decide which lists to pull from, and a strategy for combining them into a single list for our instance.</p> <h4 id=selecting-a-merge-plan>Selecting a Merge Plan<a class=headerlink href=#selecting-a-merge-plan title="Permanent link">&para;</a></h4> <p>One of the great features of FediBlockHole is the ability to specify a <code>mergeplan</code> setting of <code>min</code> or <code>max</code> when combining lists from multiple sources. The default is <code>max</code>.</p> <p>The difference between the two is how FediBlockHole resolves the conflict when the same block is encountered from different sources with different <a href=https://docs.joinmastodon.org/admin/moderation/#server-wide-moderation>severities</a>. A <code>max</code> merge plan selects the <strong>highest</strong> of the severity levels from all sources of the same block, while a <code>min</code> merge plan selects the <strong>lowest</strong>.</p> <p>We have opted to implement a <code>max</code> merge plan for our lists.</p> <h4 id=selecting-block-lists>Selecting Block Lists<a class=headerlink href=#selecting-block-lists title="Permanent link">&para;</a></h4> <p>Server moderation in the Fediverse is a little like spam filtering for email servers. It is generally up to each individual mailop to decide and implement their own spam filtering policy, with widely varying results. Over time, trusted lists of "known bad" servers (such as <a href=https://mxtoolbox.com/problem/blacklist/ >these</a>) have evolved to provide a more consistent and centralized way of filtering traffic from poorly-behaved MTAs.</p> <p><a href=https://rapidblock.org/ >The RapidBlock Project</a> is an equivalent of this for Mastodon instances, and was a clear choice for us. You can see where we pull this list in our <a href=/building/fediblockhole/#deploying-fediblockhole>FediBlockHole configuration file</a> here:</p> <div class=highlight><pre><span></span><code><span class=n>blocklist_url_sources</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>[</span>
<span class=w>  </span><span class=c1># { url = &#39;file:///path/to/fediblockhole/samples/demo-blocklist-01.csv&#39;, format = &#39;csv&#39; },</span>
<span class=w>  </span><span class=p>{</span><span class=w> </span><span class=n>url</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&#39;https://rapidblock.org/blocklist.json&#39;</span><span class=p>,</span><span class=w> </span><span class=n>format</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&#39;rapidblock.json&#39;</span><span class=w> </span><span class=p>},</span>
<span class=p>]</span>
</code></pre></div> <p>The <code>rapidblock.json</code> format is specific to RapidBlock (it is designed for use by Fediverse platforms as a whole, and not just Mastodon), and looks like this:</p> <div class="no-copy highlight"><pre><span></span><code><span class=p>{</span>
<span class=w>  </span><span class=nt>&quot;@spec&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;https://rapidblock.org/spec/v1/&quot;</span><span class=p>,</span>
<span class=w>  </span><span class=nt>&quot;publishedAt&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;2022-12-29T18:40:02.065805293Z&quot;</span><span class=p>,</span>
<span class=w>  </span><span class=nt>&quot;blocks&quot;</span><span class=p>:</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=nt>&quot;101010.pl&quot;</span><span class=p>:</span><span class=w> </span><span class=p>{</span>
<span class=w>      </span><span class=nt>&quot;isBlocked&quot;</span><span class=p>:</span><span class=w> </span><span class=kc>true</span><span class=p>,</span>
<span class=w>      </span><span class=nt>&quot;reason&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;cryptomining javascript, white supremacy&quot;</span><span class=p>,</span>
<span class=w>      </span><span class=nt>&quot;tags&quot;</span><span class=p>:</span><span class=w> </span><span class=p>[</span>
<span class=w>        </span><span class=s2>&quot;antisemitism&quot;</span><span class=p>,</span>
<span class=w>        </span><span class=s2>&quot;malware&quot;</span><span class=p>,</span>
<span class=w>        </span><span class=s2>&quot;racism&quot;</span>
<span class=w>      </span><span class=p>],</span>
<span class=w>      </span><span class=nt>&quot;dateRequested&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;2022-11-16T00:00:00Z&quot;</span><span class=p>,</span>
<span class=w>      </span><span class=nt>&quot;dateDecided&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;2022-11-16T00:00:00Z&quot;</span>
<span class=w>    </span><span class=err>...</span>
</code></pre></div> <div class="admonition note"> <p class=admonition-title>Note</p> <p>Mastodon server moderation has severity levels that are explained <a href=https://docs.joinmastodon.org/admin/moderation/#server-wide-moderation>here</a>, but you will notice from the sample RapidBlock file that no severity level is specified. This means that FediBlockHole will use the <code>max_severity</code> configuration setting, which is <code>suspend</code> by default and, if users on your instance are following accounts from the moderated domain, the <code>max_followed_severity</code> setting which defaults to <code>silence</code>.</p> </div> <p>We also came across a set of consolidated blocklists created (using FediBlockHole) from the server block lists from various "tiers" of Mastodon instances. <a href=https://writer.oliphant.social/oliphant/the-oliphant-social-blocklist>The Oliphant Social Blocklist</a> provides a number of different lists using different tiers and <a href=#selecting-a-merge-plan>merge plans</a> for each.</p> <p>And here is where the fun started. Being new, and sensitive to our goal of creating an instance safe for public service users and agencies using their public personas, we initially selected the <a href=https://codeberg.org/oliphant/blocklists/raw/branch/main/blocklists/_unified_max_blocklist.csv>Unified Max Block List</a>. This is all blocks from all tiers, using a <code>max</code> merge plan.</p> <p>This resulted in a huge blocklist, including the instance (mstdn.ca) where at least one of our team has their personal account! As noted <a href=/building/fediblockhole/#deploying-fediblockhole>here</a>, FediBlockHole has no mechanism for removing blocks that are no longer in the subscribed lists, so we had to figure out what to do next.</p> <p>Luckily, there is a <a href=https://github.com/ineffyble/mastodon-block-tools>collection of Python-based utilities</a>, from which we got a <a href=https://github.com/chdorner/secretbearsociety/blob/main/clear-blocks.py>script</a> that, once we added a timeout to avoid tripping the rate-limit on our API, did the trick.</p> <p>We now use the much more limited but still effective <a href=https://codeberg.org/oliphant/blocklists/raw/branch/main/blocklists/_unified_max_blocklist.csv>Unified Min Blocklist</a>, which combines block lists from tiers 0 through 2 servers with a <code>min</code> merge plan. You can see where we pull this list in our <a href=/building/fediblockhole/#deploying-fediblockhole>FediBlockHole configuration file</a> here:</p> <div class=highlight><pre><span></span><code><span class=n>blocklist_url_sources</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>[</span>
<span class=w>  </span><span class=c1># { url = &#39;file:///path/to/fediblockhole/samples/demo-blocklist-01.csv&#39;, format = &#39;csv&#39; },</span>
<span class=w>            </span><span class=p>{</span><span class=w> </span><span class=n>url</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&#39;https://codeberg.org/oliphant/blocklists/raw/branch/main/blocklists/_unified_min_blocklist.csv&#39;</span><span class=p>,</span><span class=w> </span><span class=n>format</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&#39;csv&#39;</span><span class=w> </span><span class=p>},</span>
<span class=p>]</span>
</code></pre></div> <div class="admonition note"> <p class=admonition-title>Note</p> <p>This list does <strong>NOT</strong> include the RapidBlock list, so we combine it with the above list, using a <code>max</code> merge plan</p> </div> <div class=footnote> <hr> <ol> <li id=fn:1> <p>We are keen to add more - please <a href=mailto:cunningpike@gmail.com>let us know</a> if there are any that should be added. Our worldview is regrettably Western-centric, and there are likely many others that we have missed.&#160;<a class=footnote-backref href=#fnref:1 title="Jump back to footnote 1 in the text">&#8617;</a></p> </li> <li id=fn:2> <p>This list is subject to change without notice, but we will keep our documentation of it, both here and on our instances, up to date.&#160;<a class=footnote-backref href=#fnref:2 title="Jump back to footnote 2 in the text">&#8617;</a></p> </li> <li id=fn:3> <p>We haven't tried this ourselves so, if you do, <a href=mailto:cunningpike@gmail.com>let us know</a> how it went!&#160;<a class=footnote-backref href=#fnref:3 title="Jump back to footnote 3 in the text">&#8617;</a></p> </li> <li id=fn:4> <p>Hat tip to <a href=https://oliphant.social/@oliphant>oliphant@oliphant.social</a> for pointing us at this!&#160;<a class=footnote-backref href=#fnref:4 title="Jump back to footnote 4 in the text">&#8617;</a></p> </li> </ol> </div> <hr> <div class=md-source-file> <small> Last update: <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-date">February 18, 2023</span> </small> </div> </article> </div> </div> <a href=# class="md-top md-icon" data-md-component=top hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg> Back to top </a> </main> <footer class=md-footer> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-copyright> <div class=md-copyright__highlight> Copyright &copy; 2023 Anthony Rodgers, GOVSocial </div> </div> <div class=md-social> <a href=https://mstdn.ca/@cunningpike target=_blank rel=noopener title=mstdn.ca class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 6.2.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M433 179.11c0-97.2-63.71-125.7-63.71-125.7-62.52-28.7-228.56-28.4-290.48 0 0 0-63.72 28.5-63.72 125.7 0 115.7-6.6 259.4 105.63 289.1 40.51 10.7 75.32 13 103.33 11.4 50.81-2.8 79.32-18.1 79.32-18.1l-1.7-36.9s-36.31 11.4-77.12 10.1c-40.41-1.4-83-4.4-89.63-54a102.54 102.54 0 0 1-.9-13.9c85.63 20.9 158.65 9.1 178.75 6.7 56.12-6.7 105-41.3 111.23-72.9 9.8-49.8 9-121.5 9-121.5zm-75.12 125.2h-46.63v-114.2c0-49.7-64-51.6-64 6.9v62.5h-46.33V197c0-58.5-64-56.6-64-6.9v114.2H90.19c0-122.1-5.2-147.9 18.41-175 25.9-28.9 79.82-30.8 103.83 6.1l11.6 19.5 11.6-19.5c24.11-37.1 78.12-34.8 103.83-6.1 23.71 27.3 18.4 53 18.4 175z"/></svg> </a> <a href=https://github.com/govsocial-org target=_blank rel=noopener title=github.com class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 496 512"><!-- Font Awesome Free 6.2.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg> </a> <a href=https://docs.govsocial.org/ target=_blank rel=noopener title=docs.govsocial.org class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M6.18 15.64a2.18 2.18 0 0 1 2.18 2.18C8.36 19 7.38 20 6.18 20 5 20 4 19 4 17.82a2.18 2.18 0 0 1 2.18-2.18M4 4.44A15.56 15.56 0 0 1 19.56 20h-2.83A12.73 12.73 0 0 0 4 7.27V4.44m0 5.66a9.9 9.9 0 0 1 9.9 9.9h-2.83A7.07 7.07 0 0 0 4 12.93V10.1Z"/></svg> </a> <a href=https://www.linkedin.com/in/anthonylrodgers target=_blank rel=noopener title=www.linkedin.com class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 6.2.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9V416z"/></svg> </a> <a href=mailto:cunningpike@gmail.com target=_blank rel=noopener title class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M17 4H7a5 5 0 0 0-5 5v11h18a2 2 0 0 0 2-2V9a5 5 0 0 0-5-5m-7 14H4V9a3 3 0 0 1 3-3 3 3 0 0 1 3 3v9m9-3h-2v-2h-4v-2h6v4M9 11H5V9h4v2Z"/></svg> </a> </div> </div> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <script id=__config type=application/json>{"base": "../..", "features": ["navigation.tabs", "navigation.tabs.sticky", "navigation.instant", "navigation.sections", "navigation.indexes", "navigation.top", "navigation.pruning", "search.suggest", "search.share", "content.code.annotate", "content.code.copy", "header.autohide", "announce.dismiss", "toc.follow"], "search": "../../assets/javascripts/workers/search.db81ec45.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script> <script src=../../assets/javascripts/bundle.a00a7c5e.min.js></script> <script src=../../extras/javascript/plausible.js></script> <script src=https://unpkg.com/tablesort@5.3.0/dist/tablesort.min.js></script> <script src=../../extras/javascript/tablesort.js></script> </body> </html>